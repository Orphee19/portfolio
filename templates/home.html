{% load static %}
{% csrf_token %}
<html lang="en">
<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Portfolio de mrs Orph</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>

    tailwind.config = {

      theme: {

        extend: {

          colors: {

            'noir-profondeur': '#1F2937',

            'bleu-mystere': '#3B5998',

            'bleu-vif': '#A1C4D6',

          }

        }

      }

    }

  </script>

  <style>

    /* CSS pour l'effet d'écriture */

    .typing-container {

      display: inline-block;

      overflow: hidden;

      border-right: 0.15em solid #A1C4D6;

      white-space: nowrap;

      width: 0;

      animation:

        typing 3s steps(30, end) forwards,

        blink-caret 0.75s step-end infinite;

    }

    @keyframes typing {

      from {

        width: 0

      }

      to {

        width: 100%

      }

    }

    @keyframes blink-caret {

      from,

      to {

        border-color: transparent

      }

      50% {

        border-color: #A1C4D6;

      }

    }

    /* Rendre le défilement fluide pour la navigation interne */

    html {

      scroll-behavior: smooth;

    }

    /* Personnalisation de la barre de défilement pour la description des projets */

    .custom-scrollbar::-webkit-scrollbar {

      width: 6px;

    }

    .custom-scrollbar::-webkit-scrollbar-thumb {

      background-color: #4b5563;

      /* Gray-600 */

      border-radius: 10px;

    }

    .custom-scrollbar::-webkit-scrollbar-track {

      background: #1f2937;

      /* Gray-800 */

    }

    /* Cacher la barre de défilement sur le conteneur des projets */

    .hide-scrollbar {

      -ms-overflow-style: none;

      /* IE and Edge */

      scrollbar-width: none;

      /* Firefox */

    }

    .hide-scrollbar::-webkit-scrollbar {

      display: none;

      /* Chrome, Safari, Opera */

    }

  </style>

  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>

<body class="bg-gray-900 min-h-screen text-gray-200">

  {% include '_header_nav.html' %}

  {% include 'acceuil.html' %}

  {% include 'about.html' %}

  {% include 'competence.html' %}

  {% include 'projet.html' %}

  {% include 'contact.html' %}

  <div id="video-modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900 bg-opacity-80 transition-opacity duration-300">

    <div class="bg-gray-800 rounded-lg shadow-2xl relative max-w-4xl w-full mx-4 p-4 md:p-6 transform transition-transform duration-300 scale-95 opacity-0">

      <button id="close-modal-btn" class="absolute top-2 right-2 text-white hover:text-red-500 transition duration-200 z-10 p-2">

        <i class="fa-solid fa-xmark text-3xl"></i>

      </button>

      <h4 id="video-modal-title" class="text-xl font-semibold text-white mb-4">Démonstration du Projet</h4>

      <div class="relative pt-[56.25%]">

        <video id="project-video-player" preload="metadata" class="absolute top-0 left-0 w-full h-full rounded-md shadow-lg" poster="{% static 'image/placeholder_projet1.jpg' %}" oncontextmenu="return false;" controlsList="nodownload">

        </video>

        <div id="custom-controls" class="absolute bottom-0 w-full bg-gray-900 bg-opacity-75 p-2 flex flex-col">

          <div id="progress-container" class="w-full h-2 bg-gray-600 rounded-full mb-2 cursor-pointer relative">

            <div id="progress-bar" class="h-full bg-bleu-vif rounded-full w-0"></div>

          </div>

          <div class="flex items-center space-x-4">

            <button id="play-pause-btn" class="text-white text-xl hover:text-bleu-vif flex items-center justify-center w-6 h-6"><i class="fa-solid fa-play"></i></button>

            <span id="current-time" class="text-xs text-gray-400">0:00</span>

            <span class="text-xs text-gray-400">/</span>

            <span id="duration" class="text-xs text-gray-400">0:00</span>

            <div class="flex-grow"></div>

            <div class="flex items-center space-x-2">

              <button id="mute-btn" class="text-white text-xl hover:text-bleu-vif"><i class="fa-solid fa-volume-up"></i></button>

              <input type="range" id="volume-slider" min="0" max="1" step="0.1" value="1" class="w-20 h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer">

            </div>

            <button id="fullscreen-btn" class="text-white text-xl hover:text-bleu-vif"><i class="fa-solid fa-expand"></i></button>

          </div>

        </div>

      </div>

    </div>

  </div>

  <script>

    // *** Logique du Menu Mobile ***

    const menuBtn = document.getElementById('menu-open-btn');

    const mobileMenu = document.getElementById('mobile-menu');

    menuBtn.innerHTML = '<i class="fa-solid fa-bars"></i>';

    menuBtn.addEventListener('click', () => {

      mobileMenu.classList.toggle('hidden');

      if (mobileMenu.classList.contains('hidden')) {

        menuBtn.innerHTML = '<i class="fa-solid fa-bars"></i>';

      } else {

        menuBtn.innerHTML = '<i class="fa-solid fa-xmark"></i>';

      }

    });

    // *** Logique de l'Effet d'écriture ***

    const texteElement = document.getElementById('typing-text');

    const professions = [

      "Développeur full-stack Python",

      "Ingénieur Génie Logiciel",

      "Développeur backend C/C++",

      "Formateur programation",

      "Infographe designeur Photoshop/Canva"

    ];

    let indexProfession = 0;

    let indexCaractere = 0;

    let delai = 150;

    let enEffacement = false;

    function taperTexte() {

      const texteActuel = professions[indexProfession];

      const span = texteElement;

      if (!enEffacement) {

        if (indexCaractere < texteActuel.length) {

          span.textContent += texteActuel.charAt(indexCaractere);

          indexCaractere++;

          setTimeout(taperTexte, delai);

        } else {

          enEffacement = true;

          setTimeout(taperTexte, 2000);

        }

      } else {

        if (indexCaractere > 0) {

          span.textContent = texteActuel.substring(0, indexCaractere - 1);

          indexCaractere--;

          setTimeout(taperTexte, delai / 2);

        } else {

          enEffacement = false;

          indexProfession = (indexProfession + 1) % professions.length;

          setTimeout(taperTexte, 500);

        }

      }

    }

    taperTexte();

    // *** Animation des Chiffres (Déclenchée à l'affichage de la section About) ***

    function animateCount(id, endValue, duration) {

      const element = document.getElementById(id);

      let startValue = 0;

      const range = endValue - startValue;

      let current = startValue;

      const increment = endValue / (duration / 10);

      const step = () => {

        current += increment;

        if (current < endValue) {

          element.textContent = Math.ceil(current);

          setTimeout(step, 10);

        } else {

          element.textContent = endValue;

        }

      };

      step();

    }

    const aboutSection = document.getElementById('about');

    const observer = new IntersectionObserver((entries, observer) => {

      entries.forEach(entry => {

        if (entry.isIntersecting) {

          animateCount('stat-projects', 9, 2000);

          animateCount('stat-experience', 3, 1500);

          observer.unobserve(entry.target);

        }

      });

    }, {

      threshold: 0.5

    });

    observer.observe(aboutSection);

    // *** Téléchargement CV & Notification (AJAX vers Django) ***

    const downloadCvLink = document.getElementById('download-cv-link');

    if (downloadCvLink) {

      downloadCvLink.addEventListener('click', () => {

        fetch('/notify-cv-download/', {

          method: 'POST',

          headers: {

            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value,

            'Content-Type': 'application/json'

          },

          body: JSON.stringify({})

        }).then(response => {

          console.log("Notification de téléchargement tentée.");

        }).catch(error => {

          console.error("Erreur lors de l'envoi de la notification:", error);

        });

      });

    }

    // *** Validation et Soumission du Formulaire de Contact (AJAX vers Django) ***

    const form = document.getElementById('contact-form');

    const nameInput = document.getElementById('contact-name');

    const emailInput = document.getElementById('contact-email');

    const messageInput = document.getElementById('contact-message');

    const nameError = document.getElementById('name-error');

    const emailError = document.getElementById('email-error');

    const messageError = document.getElementById('message-error');

    const formSuccess = document.getElementById('form-success');

    function validateEmail(email) {

      const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;

      return re.test(String(email).toLowerCase());

    }

    form.addEventListener('submit', function(event) {

      event.preventDefault();

      let isValid = true;

      // Validation Nom

      if (nameInput.value.length < 2) {

        nameError.classList.remove('hidden');

        isValid = false;

      } else {

        nameError.classList.add('hidden');

      }

      // Validation Email

      if (!validateEmail(emailInput.value)) {

        emailError.classList.remove('hidden');

        isValid = false;

      } else {

        emailError.classList.add('hidden');

      }

      // Validation Message

      if (messageInput.value.length < 10) {

        messageError.classList.remove('hidden');

        isValid = false;

      } else {

        messageError.classList.add('hidden');

      }

      if (isValid) {

        const formData = new FormData(form);

        fetch(form.action, {

            method: form.method,

            body: formData,

            headers: {

              'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value

            }

          })

          .then(response => {

            if (response.ok) {

              formSuccess.classList.remove('hidden');

              form.reset();

              setTimeout(() => formSuccess.classList.add('hidden'), 5000);

            } else {

              alert("Erreur serveur lors de l'envoi. Veuillez réessayer.");

            }

          })

          .catch(error => {

            console.error('Erreur réseau:', error);

            alert("Erreur de connexion. Veuillez vérifier votre réseau.");

          });

      }

    });

    // **********************************************

    // *** CORRECTION : Logique de la Modale Vidéo ***

    // **********************************************
    document.addEventListener('DOMContentLoaded', function() {

      // Les éléments de la modale sont recherchés UNIQUEMENT après que le DOM est prêt.

      const openBackendBtn = document.getElementById('open-backend-modal');

      const openFrontendBtn = document.getElementById('open-frontend-modal');

      const closeBtn = document.getElementById('close-modal-btn');

      const modal = document.getElementById('video-modal');

      const videoPlayer = document.getElementById('project-video-player');

      const modalTitle = document.getElementById('video-modal-title');

      // Vérifiez si la modale existe pour éviter des erreurs

      if (!modal) {

        return;

      }

      const modalContent = modal.querySelector('.max-w-4xl');

      function openModal(button) {

        const videoSrc = button.getAttribute('data-video-src');

        const videoTitle = 'Démonstration : ' + button.textContent.trim();

        if (videoPlayer) {

          videoPlayer.src = videoSrc;

          videoPlayer.load();

        }

        if (modalTitle) {

          modalTitle.textContent = videoTitle;

        }
        modal.classList.remove('hidden');

        modal.classList.add('flex');

        setTimeout(() => {

          if (modalContent) {

            modalContent.classList.remove('opacity-0', 'scale-95');

            modalContent.classList.add('opacity-100', 'scale-100');

          }

          if (videoPlayer) {

            videoPlayer.play();

          }

        }, 10);

      }

      function closeModal() {

        if (videoPlayer) {

          videoPlayer.pause();

        }

        if (modalContent) {

          modalContent.classList.remove('opacity-100', 'scale-100');

          modalContent.classList.add('opacity-0', 'scale-95');

        }

        setTimeout(() => {

          modal.classList.remove('flex');

          modal.classList.add('hidden');

          if (videoPlayer) {

            videoPlayer.src = "";

            videoPlayer.load();

          }

        }, 300);

      }

      // Attachement des événements de fermeture

      if (closeBtn) {

        // C'est cette ligne qui devrait maintenant fonctionner correctement

        closeBtn.addEventListener('click', closeModal);

      }

      // Clic en dehors de la modale (sur le fond gris)

      modal.addEventListener('click', function(e) {

        if (e.target === modal) {

          closeModal();
        }
      });

      // Touche Échap

      document.addEventListener('keydown', function(e) {

        if (e.key === "Escape" && modal.classList.contains('flex')) {

          closeModal();

        }

      });

      // Attachement des événements d'ouverture (si les boutons existent)

      if (openBackendBtn) {

        openBackendBtn.addEventListener('click', () => openModal(openBackendBtn));

      }

      if (openFrontendBtn) {

        openFrontendBtn.addEventListener('click', () => openModal(openFrontendBtn));

      }

    });

    // *** Fin CORRECTION Logique de la Modale Vidéo ***

    // **********************************************

// *** VERSION CORRIGÉE ET DÉLÉGUÉE DE LA MODALE ***

// **********************************************
document.addEventListener('DOMContentLoaded', function() {

  // --- Fonctions de base ---

  const modal = document.getElementById('video-modal');

  if (!modal) return; // Sortir si la modale n'est pas trouvée

  const videoPlayer = document.getElementById('project-video-player');
  const modalContent = modal.querySelector('.max-w-4xl');

  const modalTitle = document.getElementById('video-modal-title');

  function closeModal() {

    if (videoPlayer) {

      videoPlayer.pause();

    }
    if (modalContent) {

      modalContent.classList.remove('opacity-100', 'scale-100');

      modalContent.classList.add('opacity-0', 'scale-95');

    }

    setTimeout(() => {

      modal.classList.remove('flex');

      modal.classList.add('hidden');

      if (videoPlayer) {

        videoPlayer.src = "";

        videoPlayer.load();
      }

    }, 300);

  }

  function openModal(button) {

    const videoSrc = button.getAttribute('data-video-src');

    const videoTitle = 'Démonstration : ' + button.textContent.trim();



    if (videoPlayer) {

      videoPlayer.src = videoSrc;

      videoPlayer.load();

    }

    if (modalTitle) {

      modalTitle.textContent = videoTitle;

    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');
    setTimeout(() => {

      if (modalContent) {

        modalContent.classList.remove('opacity-0', 'scale-95');

        modalContent.classList.add('opacity-100', 'scale-100');

      }

      if (videoPlayer) {

        videoPlayer.play();

      }

    }, 10);

  }

  // --- Fin fonctions de base ---

  // *** Écouteur Délégué pour l'ouverture et la fermeture ***

  document.addEventListener('click', function(e) {
    // Fermeture avec le bouton "X" ou la touche Échap

    if (e.target && e.target.closest('#close-modal-btn')) {

      closeModal();

      return;

    }

    // Fermeture en cliquant sur le fond (modal lui-même)

    if (e.target === modal) {

      closeModal();

      return;

    }
    // Ouverture via les boutons (si vous les avez ajoutés)

    if (e.target && e.target.closest('#open-backend-modal')) {

      e.preventDefault();

      openModal(e.target.closest('#open-backend-modal'));

      return;

    }

    if (e.target && e.target.closest('#open-frontend-modal')) {

      e.preventDefault();

      openModal(e.target.closest('#open-frontend-modal'));

      return;

    }

  });

  // Fermeture avec la touche Échap

  document.addEventListener('keydown', function(e) {

    if (e.key === "Escape" && modal.classList.contains('flex')) {

      closeModal();

    }

  });

});

// *** Fin Écouteur Délégué ***
  </script>

  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>

  <script>

    AOS.init({

      duration: 1000,

      once: true

    });
    // **********************************************
// *** VERSION CORRIGÉE ET DÉLÉGUÉE DE LA MODALE ***
// **********************************************
document.addEventListener('DOMContentLoaded', function() {
    
  // --- Fonctions de base ---
  const modal = document.getElementById('video-modal');
  if (!modal) return; // Sortir si la modale n'est pas trouvée
    
  const videoPlayer = document.getElementById('project-video-player');
  const modalContent = modal.querySelector('.max-w-4xl');
  const modalTitle = document.getElementById('video-modal-title');
    
  function closeModal() {
    if (videoPlayer) {
      videoPlayer.pause();
    }

    if (modalContent) {
      modalContent.classList.remove('opacity-100', 'scale-100');
      modalContent.classList.add('opacity-0', 'scale-95');
    }

    setTimeout(() => {
      modal.classList.remove('flex');
      modal.classList.add('hidden');
      if (videoPlayer) {
        videoPlayer.src = "";
        videoPlayer.load();
      }
    }, 300);
  }

  function openModal(button) {
    const videoSrc = button.getAttribute('data-video-src');
    const videoTitle = 'Démonstration : ' + button.textContent.trim();

    if (videoPlayer) {
      videoPlayer.src = videoSrc;
      videoPlayer.load();
    }
    if (modalTitle) {
      modalTitle.textContent = videoTitle;
    }

    modal.classList.remove('hidden');
    modal.classList.add('flex');

    setTimeout(() => {
      if (modalContent) {
        modalContent.classList.remove('opacity-0', 'scale-95');
        modalContent.classList.add('opacity-100', 'scale-100');
      }
      if (videoPlayer) {
        videoPlayer.play();
      }
    }, 10);
  }
  // --- Fin fonctions de base ---


  // *** Écouteur Délégué pour l'ouverture et la fermeture ***
  document.addEventListener('click', function(e) {
    
    // Fermeture avec le bouton "X" ou la touche Échap
    if (e.target && e.target.closest('#close-modal-btn')) {
      closeModal();
      return;
    }
    
    // Fermeture en cliquant sur le fond (modal lui-même)
    if (e.target === modal) {
      closeModal();
      return;
    }
    
    // Ouverture via les boutons (si vous les avez ajoutés)
    if (e.target && e.target.closest('#open-backend-modal')) {
      e.preventDefault();
      openModal(e.target.closest('#open-backend-modal'));
      return;
    }
    if (e.target && e.target.closest('#open-frontend-modal')) {
      e.preventDefault();
      openModal(e.target.closest('#open-frontend-modal'));
      return;
    }
  });

  // Fermeture avec la touche Échap
  document.addEventListener('keydown', function(e) {
    if (e.key === "Escape" && modal.classList.contains('flex')) {
      closeModal();
    }
  });

});
// *** Fin Écouteur Délégué ***
  </script>
</body>

</html>